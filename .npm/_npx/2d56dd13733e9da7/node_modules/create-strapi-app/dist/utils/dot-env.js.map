{"version":3,"file":"dot-env.js","sources":["../../src/utils/dot-env.ts"],"sourcesContent":["import crypto from 'crypto';\nimport _ from 'lodash';\n\nimport type { Scope } from '../types';\n\nconst generateASecret = () => crypto.randomBytes(16).toString('base64');\n\nconst envTmpl = `\n# Server\nHOST=0.0.0.0\nPORT=1337\n\n# Secrets\nAPP_KEYS=<%= appKeys %>\nAPI_TOKEN_SALT=<%= apiTokenSalt %>\nADMIN_JWT_SECRET=<%= adminJwtToken %>\nTRANSFER_TOKEN_SALT=<%= transferTokenSalt %>\nENCRYPTION_KEY=<%= encryptionKey %>\n\n# Database\nDATABASE_CLIENT=<%= database.client %>\nDATABASE_HOST=<%= database.connection.host %>\nDATABASE_PORT=<%= database.connection.port %>\nDATABASE_NAME=<%= database.connection.database %>\nDATABASE_USERNAME=<%= database.connection.username %>\nDATABASE_PASSWORD=<%= database.connection.password %>\nDATABASE_SSL=<%= database.connection.ssl %>\nDATABASE_FILENAME=<%= database.connection.filename %>\n`;\n\nexport function generateDotEnv(scope: Scope) {\n  const compile = _.template(envTmpl);\n\n  return compile({\n    appKeys: new Array(4).fill(null).map(generateASecret).join(','),\n    apiTokenSalt: generateASecret(),\n    transferTokenSalt: generateASecret(),\n    adminJwtToken: generateASecret(),\n    encryptionKey: generateASecret(),\n    database: {\n      client: scope.database.client,\n      connection: {\n        ...scope.database.connection,\n        ssl: scope.database.connection?.ssl || false,\n      },\n    },\n  });\n}\n"],"names":["generateASecret","crypto","randomBytes","toString","envTmpl","generateDotEnv","scope","compile","_","template","appKeys","Array","fill","map","join","apiTokenSalt","transferTokenSalt","adminJwtToken","encryptionKey","database","client","connection","ssl"],"mappings":";;;;;AAKA,MAAMA,kBAAkB,IAAMC,MAAAA,CAAOC,WAAW,CAAC,EAAA,CAAA,CAAIC,QAAQ,CAAC,QAAA,CAAA;AAE9D,MAAMC,UAAU;;;;;;;;;;;;;;;;;;;;;AAqBhB,CAAC;AAEM,SAASC,eAAeC,KAAY,EAAA;IACzC,MAAMC,OAAAA,GAAUC,CAAEC,CAAAA,QAAQ,CAACL,OAAAA,CAAAA;AAE3B,IAAA,OAAOG,OAAQ,CAAA;QACbG,OAAS,EAAA,IAAIC,KAAM,CAAA,CAAA,CAAA,CAAGC,IAAI,CAAC,MAAMC,GAAG,CAACb,eAAiBc,CAAAA,CAAAA,IAAI,CAAC,GAAA,CAAA;QAC3DC,YAAcf,EAAAA,eAAAA,EAAAA;QACdgB,iBAAmBhB,EAAAA,eAAAA,EAAAA;QACnBiB,aAAejB,EAAAA,eAAAA,EAAAA;QACfkB,aAAelB,EAAAA,eAAAA,EAAAA;QACfmB,QAAU,EAAA;YACRC,MAAQd,EAAAA,KAAAA,CAAMa,QAAQ,CAACC,MAAM;YAC7BC,UAAY,EAAA;gBACV,GAAGf,KAAAA,CAAMa,QAAQ,CAACE,UAAU;AAC5BC,gBAAAA,GAAAA,EAAKhB,KAAMa,CAAAA,QAAQ,CAACE,UAAU,EAAEC,GAAO,IAAA;AACzC;AACF;AACF,KAAA,CAAA;AACF;;;;"}