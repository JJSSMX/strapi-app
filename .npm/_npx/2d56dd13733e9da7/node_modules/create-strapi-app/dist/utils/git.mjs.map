{"version":3,"file":"git.mjs","sources":["../../src/utils/git.ts"],"sourcesContent":["import execa from 'execa';\n\nasync function isInGitRepository(rootDir: string) {\n  try {\n    await execa('git', ['rev-parse', '--is-inside-work-tree'], { stdio: 'ignore', cwd: rootDir });\n    return true;\n  } catch (_) {\n    return false;\n  }\n}\n\nasync function isInMercurialRepository(rootDir: string) {\n  try {\n    await execa('hg', ['-cwd', '.', 'root'], { stdio: 'ignore', cwd: rootDir });\n    return true;\n  } catch (_) {\n    return false;\n  }\n}\n\nexport async function tryGitInit(rootDir: string) {\n  try {\n    await execa('git', ['--version'], { stdio: 'ignore' });\n    if ((await isInGitRepository(rootDir)) || (await isInMercurialRepository(rootDir))) {\n      return false;\n    }\n\n    await execa('git', ['init'], { stdio: 'ignore', cwd: rootDir });\n\n    await execa('git', ['add', '.'], { stdio: 'ignore', cwd: rootDir });\n    await execa('git', ['commit', '-m', 'Initial commit from Strapi'], {\n      stdio: 'ignore',\n      cwd: rootDir,\n    });\n\n    return true;\n  } catch (e) {\n    console.error('Error while trying to initialize git:', e);\n    return false;\n  }\n}\n"],"names":["isInGitRepository","rootDir","execa","stdio","cwd","_","isInMercurialRepository","tryGitInit","e","console","error"],"mappings":";;AAEA,eAAeA,kBAAkBC,OAAe,EAAA;IAC9C,IAAI;AACF,QAAA,MAAMC,MAAM,KAAO,EAAA;AAAC,YAAA,WAAA;AAAa,YAAA;SAAwB,EAAE;YAAEC,KAAO,EAAA,QAAA;YAAUC,GAAKH,EAAAA;AAAQ,SAAA,CAAA;QAC3F,OAAO,IAAA;AACT,KAAA,CAAE,OAAOI,CAAG,EAAA;QACV,OAAO,KAAA;AACT;AACF;AAEA,eAAeC,wBAAwBL,OAAe,EAAA;IACpD,IAAI;AACF,QAAA,MAAMC,MAAM,IAAM,EAAA;AAAC,YAAA,MAAA;AAAQ,YAAA,GAAA;AAAK,YAAA;SAAO,EAAE;YAAEC,KAAO,EAAA,QAAA;YAAUC,GAAKH,EAAAA;AAAQ,SAAA,CAAA;QACzE,OAAO,IAAA;AACT,KAAA,CAAE,OAAOI,CAAG,EAAA;QACV,OAAO,KAAA;AACT;AACF;AAEO,eAAeE,WAAWN,OAAe,EAAA;IAC9C,IAAI;AACF,QAAA,MAAMC,MAAM,KAAO,EAAA;AAAC,YAAA;SAAY,EAAE;YAAEC,KAAO,EAAA;AAAS,SAAA,CAAA;AACpD,QAAA,IAAI,MAAOH,iBAAAA,CAAkBC,OAAc,CAAA,IAAA,MAAMK,wBAAwBL,OAAW,CAAA,EAAA;YAClF,OAAO,KAAA;AACT;AAEA,QAAA,MAAMC,MAAM,KAAO,EAAA;AAAC,YAAA;SAAO,EAAE;YAAEC,KAAO,EAAA,QAAA;YAAUC,GAAKH,EAAAA;AAAQ,SAAA,CAAA;AAE7D,QAAA,MAAMC,MAAM,KAAO,EAAA;AAAC,YAAA,KAAA;AAAO,YAAA;SAAI,EAAE;YAAEC,KAAO,EAAA,QAAA;YAAUC,GAAKH,EAAAA;AAAQ,SAAA,CAAA;AACjE,QAAA,MAAMC,MAAM,KAAO,EAAA;AAAC,YAAA,QAAA;AAAU,YAAA,IAAA;AAAM,YAAA;SAA6B,EAAE;YACjEC,KAAO,EAAA,QAAA;YACPC,GAAKH,EAAAA;AACP,SAAA,CAAA;QAEA,OAAO,IAAA;AACT,KAAA,CAAE,OAAOO,CAAG,EAAA;QACVC,OAAQC,CAAAA,KAAK,CAAC,uCAAyCF,EAAAA,CAAAA,CAAAA;QACvD,OAAO,KAAA;AACT;AACF;;;;"}