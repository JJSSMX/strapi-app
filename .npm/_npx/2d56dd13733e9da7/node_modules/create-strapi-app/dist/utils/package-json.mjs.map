{"version":3,"file":"package-json.mjs","sources":["../../src/utils/package-json.ts"],"sourcesContent":["import { join } from 'path';\nimport { kebabCase, merge } from 'lodash';\nimport fse from 'fs-extra';\n\nimport { engines } from './engines';\nimport type { Scope } from '../types';\n\nexport async function createPackageJSON(scope: Scope) {\n  const { sortPackageJson } = await import('sort-package-json');\n\n  const pkgJSONPath = join(scope.rootPath, 'package.json');\n\n  const existingPkg = await fse.readJSON(pkgJSONPath).catch(() => ({}));\n\n  const pkg = {\n    name: kebabCase(scope.name),\n    private: true,\n    version: '0.1.0',\n    description: 'A Strapi application',\n    devDependencies: scope.devDependencies ?? {},\n    dependencies: scope.dependencies ?? {},\n    strapi: {\n      ...(scope.packageJsonStrapi ?? {}),\n      uuid: scope.uuid,\n      installId: scope.installId,\n    },\n    engines,\n  };\n\n  // copy templates\n  await fse.writeJSON(pkgJSONPath, sortPackageJson(merge(existingPkg, pkg)), {\n    spaces: 2,\n  });\n}\n"],"names":["createPackageJSON","scope","sortPackageJson","pkgJSONPath","join","rootPath","existingPkg","fse","readJSON","catch","pkg","name","kebabCase","private","version","description","devDependencies","dependencies","strapi","packageJsonStrapi","uuid","installId","engines","writeJSON","merge","spaces"],"mappings":";;;;;AAOO,eAAeA,kBAAkBC,KAAY,EAAA;AAClD,IAAA,MAAM,EAAEC,eAAe,EAAE,GAAG,MAAM,OAAO,mBAAA,CAAA;AAEzC,IAAA,MAAMC,WAAcC,GAAAA,IAAAA,CAAKH,KAAMI,CAAAA,QAAQ,EAAE,cAAA,CAAA;IAEzC,MAAMC,WAAAA,GAAc,MAAMC,GAAAA,CAAIC,QAAQ,CAACL,WAAaM,CAAAA,CAAAA,KAAK,CAAC,KAAO,EAAC,CAAA,CAAA;AAElE,IAAA,MAAMC,GAAM,GAAA;QACVC,IAAMC,EAAAA,SAAAA,CAAUX,MAAMU,IAAI,CAAA;QAC1BE,OAAS,EAAA,IAAA;QACTC,OAAS,EAAA,OAAA;QACTC,WAAa,EAAA,sBAAA;QACbC,eAAiBf,EAAAA,KAAAA,CAAMe,eAAe,IAAI,EAAC;QAC3CC,YAAchB,EAAAA,KAAAA,CAAMgB,YAAY,IAAI,EAAC;QACrCC,MAAQ,EAAA;AACN,YAAA,GAAIjB,KAAMkB,CAAAA,iBAAiB,IAAI,EAAE;AACjCC,YAAAA,IAAAA,EAAMnB,MAAMmB,IAAI;AAChBC,YAAAA,SAAAA,EAAWpB,MAAMoB;AACnB,SAAA;AACAC,QAAAA;AACF,KAAA;;AAGA,IAAA,MAAMf,IAAIgB,SAAS,CAACpB,aAAaD,eAAgBsB,CAAAA,KAAAA,CAAMlB,aAAaI,GAAO,CAAA,CAAA,EAAA;QACzEe,MAAQ,EAAA;AACV,KAAA,CAAA;AACF;;;;"}